---
layout: post
title: "A New Perspective on Time Complexity for LeetCode 1219: Path with Maximum Gold"
author: sam
categories: [ Algorithm ]
image: assets/images/leetcode1219/cover.jpg
math: true
featured: false
hidden: false
tags: ['featured']
---

## Algorithm Approach

A 2D vector is used to store the distribution of the gold mines. The algorithm first traverses the entire grid. Any coordinate with a non-zero value is treated as a starting point. We employ DFS (Depth-First Search) with backtracking to search the entire graph. During the search process, visited coordinates are marked (by setting the gold amount to 0), while tracking the currently accumulated gold.

The class maintains a `max` variable to record the maximum gold collected and a `path` variable to store the optimal path. Whenever a path yielding more gold is found, both `max` and `path` are updated simultaneously. During backtracking, the stack recording the current path is popped once, and the visited marker is released. Consequently, the path with the maximum gold and the total amount can be determined.

## Complexity Analysis

Since the search result depends on the traversal of areas containing gold, let $$k$$be the total number of cells with gold. Let$$m$$be the number of rows and$$n$$be the number of columns. Obviously,$$k \le mn$$. Therefore, any subsequent operations involving $$\min\{mn, k\}$$can be simplified directly to$$k$$.

The algorithm uses two stacks to store the path; thus, the space complexity is $$O(k+k)$$, which simplifies to $$O(k)$$.

Let us define a forward exploration step as the basic operation. Each cell with gold can serve as a starting point for DFS traversal, resulting in a total of $$k$$traversals. In each traversal, apart from the starting point, every cell has at most three different directions to proceed. Therefore, the exploration operations scale with at least$$3k$$. It follows that the worst-case time complexity is $$O(3^k)$$.

However, upon testing with map data where $$k=25$$, the execution efficiency was surprisingly high. It did not exhibit the inefficiency expected from a base-3 exponential function. This suggests that the estimated upper bound of "$$3^k$$ total exploration operations per starting point" is overly loose.

Since exploration operations only occur in cells containing gold, we analyze them separately. For any collection path, excluding the start and end cells, the intermediate cells are traversed in one of the following seven patterns:

1.  Left-in Up-out or Up-in Left-out — abbreviated as **LU**
2.  Right-in Up-out or Up-in Right-out — abbreviated as **RU**
3.  Also **LD**, **RD**, **LR**, **UD**
4.  Not traversed by the path, noted as **N**

Thus, the solution space tree, originally constructed by three exploration directions per cell, is transformed into one based on the traversal patterns of each cell.

Next, we divide all cells containing gold (excluding the start and end points) into a staggered black-and-white pattern as follows: (For convenience, assume they are clustered in a $$3 \times 3$$ grid).

![Figure1]({{site.baseurl}}/assets/images/leetcode1219/fig1.png){: .mx-auto .d-block}

From the seven patterns mentioned above, we know that if the state of every black cell is determined, the state of the white cells is implicitly determined. Therefore, we only need to consider the black cells. Clearly, this partition results in approximately $$k/2$$ black cells.

When generating the solution space tree, before traversing the 7 possibilities for cell B, the states of the four surrounding black cells have already been determined (excluding start/end points, which does not affect the complexity analysis). In the figure, if we assume A is determined as LR, then B is restricted to only four cases: LU, RU, UD, or N. The same logic applies elsewhere. Consequently, when generating the solution space tree, each black cell effectively has only 4 exploration choices for the next step. The worst-case time complexity does not exceed $$O(4^{k/2}) = O(2^k)$$.

In practice, since gold cells are not always clustered together, the available choices for each black cell will likely be fewer than 4, resulting in even lower time complexity.

In summary, the worst-case time complexity does not exceed $$O(2^k)$$.

*I encountered this problem during an algorithm course assignment. I felt the online time complexity analysis differed from my practical experience, so I made some improvements here.*